webpackJsonp([1],{NHnr:function(t,e,s){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var a=s("7+uW"),n=s("kxiW"),i=s.n(n),r={name:"AppNavbar",data:function(){return{user:null}},methods:{logout:function(){var t=this;i.a.auth().signOut().then(function(){t.$router.push({name:"Login"})})}},created:function(){var t=this;i.a.auth().currentUser;i.a.auth().onAuthStateChanged(function(e){t.user=e||null}),console.log(this.user)}},o={render:function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"navbar"},[s("nav",{staticClass:"deep-purple darken-1"},[s("div",{staticClass:"container"},[s("router-link",{staticClass:"brand-logo left",attrs:{to:{name:"Index"}}},[t._v("Random!")]),t._v(" "),s("ul",{staticClass:"right"},[t.user?t._e():s("li",[s("router-link",{attrs:{to:{name:"Signup"}}},[t._v("Signup")])],1),t._v(" "),t.user?t._e():s("li",[s("router-link",{attrs:{to:{name:"Login"}}},[t._v("Login")])],1),t._v(" "),t.user?s("li",[s("a",[t._v(t._s(t.user.email))])]):t._e(),t._v(" "),t.user?s("li",[s("a",{on:{click:t.logout}},[t._v("Logout")])]):t._e()])],1)])])},staticRenderFns:[]};var l={name:"App",components:{AppNavbar:s("VU/8")(r,o,!1,function(t){s("XdLt")},null,null).exports}},c={render:function(){var t=this.$createElement,e=this._self._c||t;return e("div",{attrs:{id:"app"}},[e("AppNavbar"),this._v(" "),e("router-view")],1)},staticRenderFns:[]};var u=s("VU/8")(l,c,!1,function(t){s("nsZW")},null,null).exports,d=s("/ocq"),p=s("Dd8w"),m=s.n(p),v={render:function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("transition",{attrs:{name:"modal"}},[s("div",{staticClass:"modal-mask"},[s("div",{staticClass:"modal-wrapper"},[s("div",{staticClass:"modal-container"},[s("div",{staticClass:"modal-header"},[t._t("header",[t._v("\n\t\t\t\t\t\tdefault header\n\t\t\t\t\t")])],2),t._v(" "),s("div",{staticClass:"modal-body"},[t._t("body",[t._v("\n\t\t\t\t\t\tdefault body\n\t\t\t\t\t")])],2),t._v(" "),s("div",{staticClass:"modal-footer"},[t._t("footer")],2),t._v(" "),s("div",{staticClass:"modal-default-button",on:{click:function(e){return t.$emit("close")}}})])])])])},staticRenderFns:[]};var f=s("VU/8")({name:"AppModal"},v,!1,function(t){s("RTmY")},null,null).exports,h=(s("881v"),i.a.initializeApp({apiKey:"AIzaSyBJwubKthjnRtCHiQXbP1T0DWQygxEtlDg",authDomain:"random-persons.firebaseapp.com",databaseURL:"https://random-persons.firebaseio.com",projectId:"random-persons",storageBucket:"random-persons.appspot.com",messagingSenderId:"940285022312"}).firestore()),_=s("NYxO"),g={name:"AppIndex",components:{AppResult:f},data:function(){return{showModal:!1,select:null,id:null,disabled:null}},created:function(){this.$store.dispatch("participants/SETCURRENTUSER"),this.$store.dispatch("participants/SETPARTICIPANTS"),this.disabled=localStorage.getItem("disabled"),this.select=localStorage.getItem("select")},computed:m()({},Object(_.b)({user:"participants/getUser",participants:"participants/getParticipants"})),methods:{close:function(){localStorage.getItem("disabled")||localStorage.setItem("disabled",!0),localStorage.setItem("select",this.select),this.disabled=!0,this.showModal=!1},choiceName:function(){var t=this,e=this.randomInteger(0,this.participants.length-1);this.participants.forEach(function(s,a){a==e&&(t.id=s.slug,t.select=s.name)}),h.collection("users").doc(this.user.id).update({choice_user:this.select}).catch(function(t){console.log(t)}),h.collection("participants").doc(this.id).update({get:!0}).catch(function(t){console.log(t)}),this.id&&(this.showModal=!0)},randomInteger:function(t,e){var s=t-.5+Math.random()*(e-t+1);return s=Math.round(s)}}},b={render:function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"container"},[t.disabled?t._e():s("div",{staticClass:"card-panel"},[s("div",{directives:[{name:"show",rawName:"v-show",value:!t.user,expression:"!user"}],staticClass:"row row-custom center"},[s("h2",{},[t._v(" Привет! ")])]),t._v(" "),t.user?s("div",{staticClass:"row center"},[s("h2",{},[t._v(" Нажми на кнопку выбрать кому ты даришь подарок!")]),t._v(" "),s("button",{staticClass:"btn btn-custom",attrs:{id:"show-modal",disabled:t.disabled},on:{click:function(e){return t.choiceName()}}},[t._v(" Кнопка!\n\t\t\t")])]):t._e(),t._v(" "),t.showModal?s("app-result",{on:{close:t.close}},[s("h3",{attrs:{slot:"header"},slot:"header"},[t._v("Человек которумы ты даришь подарок!")]),t._v(" "),s("span",{attrs:{slot:"body"},slot:"body"},[t._v(t._s(t.select))])]):t._e()],1),t._v(" "),t.disabled?s("div",{staticClass:"card-panel"},[s("h2",{staticClass:"center"},[t._v(" Ты даришь подарок "+t._s(t.select))])]):t._e()])},staticRenderFns:[]};var w=s("VU/8")(g,b,!1,function(t){s("ZrI3")},null,null).exports,C=s("ORum"),x=s.n(C),E={name:"Signup",data:function(){return{email:null,password:null,feedback:null,selected:null,slug:null,participants:[]}},beforeMount:function(){var t=this;h.collection("participants").get().then(function(e){e.docs.forEach(function(e){var s=e.data();s.slug=e.id,s.give||t.participants.unshift(s)})}).catch(function(t){console.log(t)})},methods:{signup:function(){var t=this;if(this.email&&this.password&&this.selected){this.slug=x()(this.selected,{replacement:"-",remove:/[$*_+~.()'"!\-:@]/g,lower:!0});var e=h.collection("users").doc(this.slug);e.get().then(function(s){s.exists?t.feedback="This alias already exists":(i.a.auth().createUserWithEmailAndPassword(t.email,t.password).then(function(s){e.set({alias:t.selected,selected_id:t.slug,user_id:s.user.uid})}).then(function(){h.collection("participants").doc(t.selected).update({give:!0}),t.$router.push({name:"Index"})}).catch(function(e){console.log(e),t.feedback=e.message}),t.feedback="This alias is free to use")})}else this.feedback="You must enter all fields"}}},k={render:function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"signup container"},[s("form",{staticClass:"card-panel",on:{submit:function(e){return e.preventDefault(),t.signup(e)}}},[s("h2",{staticClass:"center deep-purple-text"},[t._v("Signup")]),t._v(" "),s("div",{staticClass:"field"},[s("label",{attrs:{for:"email"}},[t._v("Почта")]),t._v(" "),s("input",{directives:[{name:"model",rawName:"v-model",value:t.email,expression:"email"}],attrs:{id:"email",type:"email"},domProps:{value:t.email},on:{input:function(e){e.target.composing||(t.email=e.target.value)}}})]),t._v(" "),s("div",{staticClass:"field"},[s("label",{attrs:{for:"password"}},[t._v("Пароль")]),t._v(" "),s("input",{directives:[{name:"model",rawName:"v-model",value:t.password,expression:"password"}],attrs:{id:"password",type:"password"},domProps:{value:t.password},on:{input:function(e){e.target.composing||(t.password=e.target.value)}}})]),t._v(" "),s("div",{staticClass:"field"},[s("label",{attrs:{for:"selected"}},[t._v("Имя")]),t._v(" "),s("select",{directives:[{name:"model",rawName:"v-model",value:t.selected,expression:"selected"}],staticClass:"browser-default",attrs:{value:"",id:"selected"},on:{change:function(e){var s=Array.prototype.filter.call(e.target.options,function(t){return t.selected}).map(function(t){return"_value"in t?t._value:t.value});t.selected=e.target.multiple?s:s[0]}}},t._l(t.participants,function(e){return s("option",{domProps:{value:e.slug}},[t._v("\n\t\t\t\t\t"+t._s(e.name)+"\n\t\t\t\t")])}),0)]),t._v(" "),t.feedback?s("p",{staticClass:"red-text center"},[t._v(t._s(t.feedback))]):t._e(),t._v(" "),t._m(0)])])},staticRenderFns:[function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"field center"},[e("button",{staticClass:"btn deep-purple"},[this._v("Signup")])])}]};var S=s("VU/8")(E,k,!1,function(t){s("vbwx")},null,null).exports,A={name:"Login",data:function(){return{email:null,password:null,feedback:null}},methods:{login:function(){var t=this;this.email&&this.password?(i.a.auth().signInWithEmailAndPassword(this.email,this.password).then(function(e){console.log(e),t.$router.push({name:"Index"})}).catch(function(e){t.feedback=e.message}),this.feedback=null):this.feedback="Please fill in both fields"}}},I={render:function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"login container"},[s("form",{staticClass:"card-panel",on:{submit:function(e){return e.preventDefault(),t.login(e)}}},[s("h2",{staticClass:"center deep-purple-text"},[t._v("Login")]),t._v(" "),s("div",{staticClass:"field"},[s("label",{attrs:{for:"email"}},[t._v("Email")]),t._v(" "),s("input",{directives:[{name:"model",rawName:"v-model",value:t.email,expression:"email"}],attrs:{id:"email",type:"email"},domProps:{value:t.email},on:{input:function(e){e.target.composing||(t.email=e.target.value)}}})]),t._v(" "),s("div",{staticClass:"field"},[s("label",{attrs:{for:"password"}},[t._v("Password")]),t._v(" "),s("input",{directives:[{name:"model",rawName:"v-model",value:t.password,expression:"password"}],attrs:{id:"password",type:"password"},domProps:{value:t.password},on:{input:function(e){e.target.composing||(t.password=e.target.value)}}})]),t._v(" "),t.feedback?s("p",{staticClass:"red-text center"},[t._v(t._s(t.feedback))]):t._e(),t._v(" "),t._m(0)])])},staticRenderFns:[function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"field"},[e("button",{staticClass:"btn deep-purple"},[this._v("Login")])])}]};var U=s("VU/8")(A,I,!1,function(t){s("X6z6")},null,null).exports,R={render:function(){this.$createElement;this._self._c;return this._m(0)},staticRenderFns:[function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"container"},[e("h1",[this._v(" Hello ")])])}]};var P=s("VU/8")({name:"AppCurrentUser"},R,!1,function(t){s("VBM/")},"data-v-638b8923",null).exports;a.a.use(d.a);var N=new d.a({mode:"history",routes:[{path:"/",name:"Index",component:w},{path:"/signup",name:"Signup",component:S},{path:"/login",name:"Login",component:U},{path:"/user/:id",name:"CurrentUser",component:P,meta:{requiresAuth:!0}}]});N.beforeEach(function(t,e,s){t.matched.some(function(t){return t.meta.requiresAuth})?i.a.auth().currentUser?s():s({name:"Index"}):s()});var y=N,$={namespaced:!0,state:{user:null,participants:[],selectedUser:null},getters:{getUser:function(t){return t.user},getParticipants:function(t){return t.participants}},mutations:{setDisabled:function(t,e){},setUser:function(t){var e=i.a.auth().currentUser,s=h.collection("users");e&&s.where("user_id","==",e.uid).get().then(function(e){e.forEach(function(e){e?(t.user=e.data(),t.user.id=e.id):t.user=null})})},setParticipants:function(t){var e=t.user&&t.user.selected_id?t.user.selected_id:null;h.collection("participants").get().then(function(s){s.docs.forEach(function(s){var a=s.data();a.slug=s.id,s.id==e||a.get||t.participants.unshift(a)})})}},actions:{SETCURRENTUSER:function(t){(0,t.commit)("setUser")},SETPARTICIPANTS:function(t){(0,t.commit)("setParticipants")}}};a.a.use(_.a);var T=new _.a.Store({modules:{participants:$}});a.a.config.productionTip=!1;var L=null;i.a.auth().onAuthStateChanged(function(){L||(L=new a.a({el:"#app",store:T,router:y,components:{App:u},template:"<App/>"}))})},RTmY:function(t,e){},"VBM/":function(t,e){},X6z6:function(t,e){},XdLt:function(t,e){},ZrI3:function(t,e){},nsZW:function(t,e){},vbwx:function(t,e){}},["NHnr"]);
//# sourceMappingURL=app.28dd01b15c52315101be.js.map